---
import BentoBox from '@/components/layout/BentoBox.astro';
import Header from '@/components/page/Header.astro';
import { figures } from "@/config";

const convertNumberFormat = (num: number): string => {
    if (num >= 1_000_000_000_000) {
        return (num / 1_000_000_000_000).toFixed(2).replace(/\.00$/, '') + 'T';
    } else if (num >= 1_000_000_000) {
        return (num / 1_000_000_000).toFixed(2).replace(/\.00$/, '') + 'B';
    } else if (num >= 1_000_000) {
        return (num / 1_000_000).toFixed(2).replace(/\.00$/, '') + 'M';
    } else if (num >= 1_000) {
        return (num / 1_000).toFixed(2).replace(/\.00$/, '') + 'k';
    }
    return num.toString();
};
---

<Header title="Numbers" subtitle="Some facts and figures." />
<section id="beyond">
  <div class="max-w-6xl">
    <div class="mb-12 grid grid-cols-2 lg:grid-cols-4 gap-6">
      {figures.map(figure => {
        // Prepare link props if url exists
        const linkProps = figure.url
          ? {
              href: figure.url,
              target: "_blank",
              rel: figure.external ? "noopener noreferrer" : undefined,
              hoverHighlight: true
            }
          : {};
        return (
          <BentoBox className="aspect-square" {...linkProps}>
            <div class="flex flex-col justify-center items-center h-full text-center">
              {figure.lastUpdated && (
                <span class="text-sm text-muted-foreground">
                  {figure.lastUpdated.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                </span>
              )}
              <span class="font-bold text-6xl">{convertNumberFormat(figure.figure)}</span>
              <span class="text-muted-foreground">{figure.description}</span>
            </div>
          </BentoBox>
        );
      })}
    </div>
  </div>
</section>
