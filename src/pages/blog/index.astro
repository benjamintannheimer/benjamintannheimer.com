---
import PageLayout from "@/layouts/PageLayout.astro";
import { buttonVariants } from "@/components/ui/button";
import { getPosts } from "@/lib/getPosts";
import { blogPageContent } from "@/config";
import BentoBox from "@/components/layout/BentoBox.astro";

const posts = await getPosts();

const { seo, page } = blogPageContent;
---

<PageLayout seo={seo} page={page}>
  <!-- Blog Post List -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    {posts.map((post: any) => (
      <BentoBox 
        className="relative overflow-hidden border aspect-square rounded-lg shadow-md hover:shadow-lg transition duration-300 flex flex-col h-full group" 
        padding={false}
      >
        <!-- Background Image -->
        <img 
          src={post.data.image.url} 
          alt={post.data.image.alt} 
          loading="lazy" 
          class="absolute inset-0 object-cover w-full h-full transition-transform aspect-square duration-500 ease-in-out group-hover:scale-55" 
        />

        <!-- Content Overlay -->
        <a 
          href={`/blog/${post.slug}`} 
          aria-label={`Read more about ${post.data.title}`}
          class="relative z-10 flex flex-col h-full bg-black/50 text-white p-6"
        >
          <div class="flex flex-col flex-grow">
            <h2 class="text-xl font-bold mb-2 line-clamp-2">{post.data.title}</h2>
            <p class="text-sm mb-4">
              {new Date(post.data.pubDate).toLocaleDateString("de-CH")}
            </p>
            <p class="mb-4 flex-grow line-clamp-3">
              {post.data.description}
            </p>
            <button 
              class={buttonVariants({ variant: 'default' }) + " mt-auto self-start"}
            >
              Read More
            </button>
          </div>
        </a>
      </BentoBox>
    ))}
  </div>
</PageLayout>
